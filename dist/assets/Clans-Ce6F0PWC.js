import{E as y,r,z as n,j as e,S as c,k as w,U as _,e as C,v as T}from"./index-Cb_Vey4A.js";import{P as A}from"./plus-CkSgRXyI.js";function F(){const{user:l}=y(),[h,g]=r.useState([]),[t,j]=r.useState(null),[i,b]=r.useState(""),[D,f]=r.useState(!1),[N,o]=r.useState(!1);r.useEffect(()=>{l&&(x(),m())},[l]);const x=async()=>{const{data:s,error:a}=await n.from("game_clans").select("*").order("total_hashrate",{ascending:!1}).limit(50);s&&g(s)},m=async()=>{if(!l)return;const{data:s}=await n.from("game_clan_members").select("clan_id, game_clans(*)").eq("user_id",l.id).single();s?.game_clans&&j(s.game_clans)},v=async s=>{if(l){o(!0);try{const{error:a}=await n.from("game_clan_members").insert({clan_id:s,user_id:l.id,rank:"private"});if(a)throw a;alert("Successfully joined the clan!"),m(),x()}catch(a){console.error("Join clan error:",a),alert(a.message||"Failed to join clan")}finally{o(!1)}}},d=h.filter(s=>s.name.toLowerCase().includes(i.toLowerCase())||s.tag.toLowerCase().includes(i.toLowerCase()));return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Clans & Wars"}),e.jsx("p",{className:"text-gray-400",children:"Join forces and compete for glory and rewards"})]}),t&&e.jsx("div",{className:"bg-gradient-to-br from-[#D2A44C]/20 to-yellow-600/20 rounded-xl p-6 border border-[#D2A44C]/30",children:e.jsxs("div",{className:"flex items-start gap-6",children:[e.jsx("div",{className:"w-24 h-24 bg-gray-800 rounded-lg flex items-center justify-center",children:t.image_url?e.jsx("img",{src:t.image_url,alt:t.name,className:"w-full h-full object-cover rounded-lg"}):e.jsx(c,{className:"w-12 h-12 text-[#D2A44C]"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:t.name}),e.jsxs("span",{className:"px-3 py-1 bg-[#D2A44C]/30 text-[#D2A44C] rounded-lg font-bold",children:["[",t.tag,"]"]})]}),e.jsx("p",{className:"text-gray-300 mb-4",children:t.description}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-400",children:"Members"}),e.jsx("div",{className:"text-xl font-bold text-white",children:t.total_members})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-400",children:"Total Hashrate"}),e.jsxs("div",{className:"text-xl font-bold text-white",children:[t.total_hashrate.toFixed(2)," TH/s"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-400",children:"Wins/Losses"}),e.jsxs("div",{className:"text-xl font-bold text-white",children:[t.win_count,"/",t.loss_count]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-400",children:"Global Rank"}),e.jsxs("div",{className:"text-xl font-bold text-[#D2A44C]",children:["#",t.global_rank||"â€”"]})]})]})]})]})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(w,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",value:i,onChange:s=>b(s.target.value),placeholder:"Search clans...",className:"w-full pl-12 pr-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-[#D2A44C]"})]}),!t&&e.jsxs("button",{onClick:()=>f(!0),className:"flex items-center gap-2 px-6 py-3 bg-[#D2A44C] text-white font-bold rounded-lg hover:bg-yellow-600 transition-all",children:[e.jsx(A,{className:"w-5 h-5"}),"Create Clan"]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Top Clans"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:d.slice(0,3).map((s,a)=>{const u=["ðŸ¥‡","ðŸ¥ˆ","ðŸ¥‰"],p=["from-yellow-500/20 to-yellow-600/20 border-yellow-500/30","from-gray-400/20 to-gray-500/20 border-gray-400/30","from-orange-500/20 to-orange-600/20 border-orange-500/30"];return e.jsxs("div",{className:`bg-gradient-to-br ${p[a]} rounded-xl p-6 border`,children:[e.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[e.jsx("div",{className:"text-4xl",children:u[a]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:s.name}),e.jsxs("span",{className:"text-sm text-gray-400",children:["[",s.tag,"]"]})]}),e.jsx("p",{className:"text-sm text-gray-400 line-clamp-2",children:s.description})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-400",children:"Members"}),e.jsx("div",{className:"text-white font-bold",children:s.total_members})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-400",children:"Hashrate"}),e.jsxs("div",{className:"text-white font-bold",children:[s.total_hashrate.toFixed(1)," TH/s"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-400",children:"Wins"}),e.jsx("div",{className:"text-white font-bold",children:s.win_count})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-400",children:"BTC Won"}),e.jsx("div",{className:"text-white font-bold",children:s.total_btc_won.toFixed(4)})]})]})]},s.id)})})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"All Clans"}),e.jsx("div",{className:"space-y-4",children:d.slice(3).map(s=>e.jsx("div",{className:"bg-gradient-to-br from-gray-800/50 to-gray-900/50 rounded-xl p-6 border border-gray-700/50 hover:border-[#D2A44C]/30 transition-all",children:e.jsxs("div",{className:"flex items-start gap-6",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-800 rounded-lg flex items-center justify-center flex-shrink-0",children:s.image_url?e.jsx("img",{src:s.image_url,alt:s.name,className:"w-full h-full object-cover rounded-lg"}):e.jsx(c,{className:"w-8 h-8 text-[#D2A44C]"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:s.name}),e.jsxs("span",{className:"px-2 py-1 bg-gray-700 text-gray-300 rounded text-sm font-bold",children:["[",s.tag,"]"]}),s.global_rank&&s.global_rank<=10&&e.jsxs("span",{className:"px-2 py-1 bg-[#D2A44C]/20 text-[#D2A44C] rounded text-xs",children:["Top ",s.global_rank]})]}),e.jsx("p",{className:"text-gray-400 mt-1",children:s.description})]}),!t&&s.is_recruiting&&e.jsx("button",{onClick:()=>v(s.id),disabled:N,className:"px-4 py-2 bg-[#D2A44C] text-white rounded-lg hover:bg-yellow-600 transition-all disabled:opacity-50",children:"Join"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-400 text-sm",children:[e.jsx(_,{className:"w-4 h-4"}),e.jsx("span",{children:"Members"})]}),e.jsx("div",{className:"text-white font-bold",children:s.total_members})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-400 text-sm",children:[e.jsx(C,{className:"w-4 h-4"}),e.jsx("span",{children:"Hashrate"})]}),e.jsxs("div",{className:"text-white font-bold",children:[s.total_hashrate.toFixed(2)," TH/s"]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-400 text-sm",children:[e.jsx(T,{className:"w-4 h-4"}),e.jsx("span",{children:"W/L"})]}),e.jsxs("div",{className:"text-white font-bold",children:[s.win_count,"/",s.loss_count]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-400 text-sm",children:"BTC Won"}),e.jsx("div",{className:"text-white font-bold",children:s.total_btc_won.toFixed(4)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-400 text-sm",children:"TYT Won"}),e.jsx("div",{className:"text-white font-bold",children:s.total_tyt_won.toFixed(2)})]})]}),s.min_hashrate_requirement>0&&e.jsxs("div",{className:"mt-3 text-sm text-gray-400",children:["Minimum hashrate requirement: ",s.min_hashrate_requirement," TH/s"]})]})]})},s.id))})]}),d.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(c,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"No Clans Found"}),e.jsx("p",{className:"text-gray-400",children:"Try adjusting your search or create a new clan!"})]})]})}export{F as default};
