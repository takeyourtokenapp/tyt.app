import{E as C,r as u,z as n,j as a,v as h,Z as I,e as E,H as F,U as H,t as U,f as O,T as P,s as Y}from"./index-Cb_Vey4A.js";import{S as D}from"./star-BbgnQ6L2.js";import{M as _}from"./medal-wZV0X95f.js";function X(){const{user:g}=C(),[c,y]=u.useState("hashrate"),[f,j]=u.useState([]),[m,w]=u.useState(null),[N,b]=u.useState(!0);u.useEffect(()=>{k()},[c]);const k=async()=>{if(g){b(!0);try{let e=[];switch(c){case"hashrate":e=await T();break;case"rewards":e=await L();break;case"charity":e=await A();break;case"referrals":e=await S();break;case"vip":e=await R();break;case"academy":e=await $();break}j(e);const t=e.find(l=>l.user_id===g.id);w(t||null)}catch(e){console.error("Error loading leaderboard:",e)}finally{b(!1)}}},T=async()=>{const{data:e,error:t}=await n.from("nft_miners").select(`
        owner_id,
        hashrate,
        profiles!nft_miners_owner_id_fkey (
          id,
          username,
          email
        )
      `).eq("status","active");if(t||!e)return[];const l=e.reduce((r,s)=>{const o=s.owner_id;return r[o]||(r[o]={user_id:o,username:s.profiles?.username||s.profiles?.email?.split("@")[0]||"Anonymous",avatar_url:void 0,value:0}),r[o].value+=parseFloat(s.hashrate),r},{});return Object.values(l).sort((r,s)=>s.value-r.value).slice(0,100).map((r,s)=>({...r,rank:s+1,badge:s===0?"gold":s===1?"silver":s===2?"bronze":void 0}))},L=async()=>{const{data:e,error:t}=await n.from("daily_rewards").select(`
        user_id,
        btc_amount,
        profiles!daily_rewards_user_id_fkey (
          id,
          username,
          email
        )
      `);if(t||!e)return[];const l=e.reduce((r,s)=>{const o=s.user_id;return r[o]||(r[o]={user_id:o,username:s.profiles?.username||s.profiles?.email?.split("@")[0]||"Anonymous",avatar_url:void 0,value:0}),r[o].value+=parseFloat(s.btc_amount),r},{});return Object.values(l).sort((r,s)=>s.value-r.value).slice(0,100).map((r,s)=>({...r,rank:s+1,badge:s===0?"gold":s===1?"silver":s===2?"bronze":void 0}))},A=async()=>{const{data:e,error:t}=await n.from("charity_stakes").select(`
        user_id,
        total_donated,
        profiles!charity_stakes_user_id_fkey (
          id,
          username,
          email
        )
      `).eq("status","active");if(t||!e)return[];const l=e.reduce((r,s)=>{const o=s.user_id;return r[o]||(r[o]={user_id:o,username:s.profiles?.username||s.profiles?.email?.split("@")[0]||"Anonymous",avatar_url:void 0,value:0}),r[o].value+=parseFloat(s.total_donated),r},{});return Object.values(l).sort((r,s)=>s.value-r.value).slice(0,100).map((r,s)=>({...r,rank:s+1,badge:s===0?"gold":s===1?"silver":s===2?"bronze":void 0}))},S=async()=>{const{data:e,error:t}=await n.from("referral_earnings").select("referrer_id");if(t||!e)return[];const l=e.reduce((i,d)=>{const p=d.referrer_id;return i[p]=(i[p]||0)+1,i},{}),r=Object.keys(l);if(r.length===0)return[];const{data:s}=await n.from("profiles").select("id, username, email").in("id",r);return s?s.map(i=>({user_id:i.id,username:i.username||i.email?.split("@")[0]||"Anonymous",avatar_url:void 0,value:l[i.id]||0})).sort((i,d)=>d.value-i.value).slice(0,100).map((i,d)=>({...i,rank:d+1,badge:d===0?"gold":d===1?"silver":d===2?"bronze":void 0})):[]},R=async()=>{const{data:e,error:t}=await n.from("profiles").select("id, username, email, vip_level").order("vip_level",{ascending:!1}).limit(100);return t||!e?[]:e.map((l,r)=>({user_id:l.id,username:l.username||l.email?.split("@")[0]||"Anonymous",avatar_url:void 0,rank:r+1,value:l.vip_level||0,badge:r===0?"gold":r===1?"silver":r===2?"bronze":void 0}))},$=async()=>{const{data:e,error:t}=await n.from("user_academy_stats").select(`
        user_id,
        total_xp,
        profiles!user_academy_stats_user_id_fkey (
          id,
          username,
          email
        )
      `).order("total_xp",{ascending:!1}).limit(100);return t||!e?[]:e.map((l,r)=>({user_id:l.user_id,username:l.profiles?.username||l.profiles?.email?.split("@")[0]||"Anonymous",avatar_url:void 0,rank:r+1,value:l.total_xp||0,badge:r===0?"gold":r===1?"silver":r===2?"bronze":void 0}))},z=[{id:"hashrate",label:"Top Hashrate",icon:I,color:"text-yellow-400"},{id:"rewards",label:"Top Earners",icon:E,color:"text-green-400"},{id:"charity",label:"Top Donors",icon:F,color:"text-pink-400"},{id:"referrals",label:"Top Referrers",icon:H,color:"text-blue-400"},{id:"vip",label:"VIP Status",icon:U,color:"text-gold-400"},{id:"academy",label:"Academy XP",icon:O,color:"text-purple-400"}],x=e=>e===1?a.jsx(h,{className:"w-6 h-6 text-gold-400"}):e===2?a.jsx(_,{className:"w-6 h-6 text-gray-300"}):e===3?a.jsx(_,{className:"w-6 h-6 text-orange-400"}):a.jsxs("span",{className:"text-gray-500 font-bold",children:["#",e]}),v=(e,t)=>{switch(e){case"hashrate":return`${t.toFixed(2)} TH/s`;case"rewards":return`${t.toFixed(8)} BTC`;case"charity":return`${t.toLocaleString()} TYT`;case"referrals":return`${t} referrals`;case"vip":return`Level ${t}`;case"academy":return`${t.toLocaleString()} XP`;default:return t.toString()}};return N?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"w-8 h-8 border-4 border-gold-400 border-t-transparent rounded-full animate-spin"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("h1",{className:"text-3xl font-bold mb-2 flex items-center gap-3",children:[a.jsx(h,{className:"w-8 h-8 text-gold-400"}),"Global Leaderboard"]}),a.jsx("p",{className:"text-gray-400",children:"Compete with the TYT community"})]}),m&&a.jsx("div",{className:"bg-gradient-to-br from-gold-900/30 to-amber-900/30 rounded-xl p-6 border border-gold-500/50",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[x(m.rank),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm text-gray-400",children:"Your Rank"}),a.jsxs("div",{className:"text-2xl font-bold",children:["#",m.rank]})]})]}),a.jsx("div",{className:"h-12 w-px bg-gray-700"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm text-gray-400",children:"Your Score"}),a.jsx("div",{className:"text-xl font-bold",children:v(c,m.value)})]})]}),a.jsx(D,{className:"w-8 h-8 text-gold-400 fill-gold-400"})]})}),a.jsxs("div",{className:"bg-gray-800/50 rounded-xl border border-gray-700 overflow-hidden",children:[a.jsx("div",{className:"flex overflow-x-auto border-b border-gray-700",children:z.map(e=>a.jsxs("button",{onClick:()=>y(e.id),className:`flex-shrink-0 px-6 py-4 font-semibold transition-all flex items-center justify-center gap-2 ${c===e.id?"bg-gold-500/20 text-gold-400 border-b-2 border-gold-500":"text-gray-400 hover:text-white hover:bg-gray-800/50"}`,children:[a.jsx(e.icon,{size:18,className:c===e.id?e.color:""}),a.jsx("span",{className:"hidden sm:inline",children:e.label})]},e.id))}),a.jsx("div",{className:"p-6",children:f.length===0?a.jsxs("div",{className:"text-center py-12 text-gray-400",children:[a.jsx(P,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),a.jsx("p",{children:"No data available yet"})]}):a.jsx("div",{className:"space-y-2",children:f.map(e=>a.jsxs("div",{className:`flex items-center justify-between p-4 rounded-lg transition-all ${e.user_id===g?.id?"bg-gold-500/10 border border-gold-500/30":"bg-gray-800/50 hover:bg-gray-800"}`,children:[a.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[a.jsx("div",{className:"w-12 flex items-center justify-center",children:x(e.rank)}),a.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-gold-500/20 to-amber-500/20 flex items-center justify-center text-xl font-bold text-gold-400",children:e.username[0].toUpperCase()}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"font-bold flex items-center gap-2",children:[e.username,e.badge&&a.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${e.badge==="gold"?"bg-gold-500/20 text-gold-400":e.badge==="silver"?"bg-gray-500/20 text-gray-300":"bg-orange-500/20 text-orange-400"}`,children:e.badge})]}),a.jsx("div",{className:"text-sm text-gray-400",children:v(c,e.value)})]})]}),a.jsx(Y,{className:"w-5 h-5 text-gray-600"})]},e.user_id))})})]})]})}export{X as default};
