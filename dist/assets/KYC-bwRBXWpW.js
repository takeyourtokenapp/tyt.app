import{c as U,E as S,r as o,z as n,j as e,O as j,ap as A,F as m,_ as P}from"./index-Cb_Vey4A.js";import{C as b}from"./clock-ClFQAG9n.js";import{U as F}from"./upload-D6vFaWue.js";const E=U("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),I={passport:{label:"Passport",icon:m,description:"Upload a clear photo of your passport main page"},id_card:{label:"National ID Card",icon:m,description:"Upload both front and back sides of your ID"},drivers_license:{label:"Driver's License",icon:m,description:"Upload both front and back sides of your license"},proof_of_address:{label:"Proof of Address",icon:A,description:"Upload a recent utility bill, bank statement, or official document"},selfie:{label:"Selfie Verification",icon:E,description:"Upload a selfie holding your ID document"}};function T(){const{user:a}=S(),[y,v]=o.useState([]),[N,x]=o.useState(null),[r,w]=o.useState(null);o.useEffect(()=>{a&&(u(),p())},[a]);const u=async()=>{if(!a)return;const{data:s}=await n.from("kyc_verifications").select("*").eq("user_id",a.id).single();s&&w(s)},p=async()=>{if(!a)return;const{data:s}=await n.from("kyc_documents").select("*").eq("user_id",a.id).order("uploaded_at",{ascending:!1});s&&v(s)},h=async(s,d)=>{const i=d.target.files?.[0];if(!(!i||!a)){if(!i.type.startsWith("image/")&&i.type!=="application/pdf"){alert("Please upload an image or PDF file");return}if(i.size>10*1024*1024){alert("File size must be less than 10MB");return}x(s);try{const t=i.name.split(".").pop(),l=`${a.id}/${s}_${Date.now()}.${t}`,{data:c,error:g}=await n.storage.from("kyc-documents").upload(l,i);if(g)throw g;const{data:k}=n.storage.from("kyc-documents").getPublicUrl(l),{error:f}=await n.from("kyc_documents").insert({user_id:a.id,document_type:s,document_url:k.publicUrl,status:"pending"});if(f)throw f;await n.from("kyc_verifications").upsert({user_id:a.id,status:"pending_review",submitted_at:new Date().toISOString()}),alert("Document uploaded successfully!"),p(),u()}catch(t){console.error("Upload error:",t),alert(t.message||"Failed to upload document")}finally{x(null)}}},_=s=>{switch(s){case"approved":return e.jsxs("div",{className:"flex items-center gap-2 text-green-400",children:[e.jsx(j,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Approved"})]});case"rejected":return e.jsxs("div",{className:"flex items-center gap-2 text-red-400",children:[e.jsx(P,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Rejected"})]});default:return e.jsxs("div",{className:"flex items-center gap-2 text-yellow-400",children:[e.jsx(b,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Pending Review"})]})}},D=s=>{switch(s){case"approved":return"text-green-400";case"rejected":return"text-red-400";case"pending_review":return"text-yellow-400";default:return"text-gray-400"}},C=s=>y.find(d=>d.document_type===s);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"KYC Verification"}),e.jsx("p",{className:"text-gray-400",children:"Complete your identity verification to unlock all features"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-gray-800/50 to-gray-900/50 rounded-xl p-6 border border-gray-700/50",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-2",children:"Verification Status"}),e.jsxs("div",{className:`text-lg font-medium ${D(r?.status||"not_submitted")}`,children:[r?.status==="approved"&&"Verified ✓",r?.status==="pending_review"&&"Pending Review",r?.status==="rejected"&&"Verification Failed",!r?.status&&"Not Started"]}),r?.tier&&e.jsxs("div",{className:"text-sm text-gray-400 mt-1",children:["KYC Tier: ",r.tier]})]}),r?.status==="approved"&&e.jsx("div",{className:"px-4 py-2 bg-green-500/20 border border-green-500/30 rounded-lg",children:e.jsx(j,{className:"w-8 h-8 text-green-400"})})]}),r?.rejection_reason&&e.jsx("div",{className:"mt-4 p-4 bg-red-500/10 border border-red-500/30 rounded-lg",children:e.jsxs("p",{className:"text-sm text-red-400",children:[e.jsx("strong",{children:"Rejection Reason:"})," ",r.rejection_reason]})})]}),e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:[e.jsx("h3",{className:"text-white font-medium mb-2",children:"Important Guidelines"}),e.jsxs("ul",{className:"space-y-1 text-sm text-gray-300",children:[e.jsx("li",{children:"• All documents must be clear and readable"}),e.jsx("li",{children:"• Accepted formats: JPG, PNG, PDF"}),e.jsx("li",{children:"• Maximum file size: 10MB"}),e.jsx("li",{children:"• Documents must be valid and not expired"}),e.jsx("li",{children:"• Selfie must clearly show your face and ID"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:Object.entries(I).map(([s,d])=>{const i=d.icon,t=C(s),l=N===s;return e.jsx("div",{className:"bg-gradient-to-br from-gray-800/50 to-gray-900/50 rounded-xl p-6 border border-gray-700/50",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-[#D2A44C]/20 rounded-lg",children:e.jsx(i,{className:"w-6 h-6 text-[#D2A44C]"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-1",children:d.label}),e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:d.description}),t?e.jsxs("div",{className:"space-y-3",children:[_(t.status),t.rejection_reason&&e.jsx("p",{className:"text-sm text-red-400",children:t.rejection_reason}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Uploaded: ",new Date(t.uploaded_at).toLocaleDateString()]}),t.status==="rejected"&&e.jsxs("label",{className:"block",children:[e.jsx("input",{type:"file",accept:"image/*,.pdf",onChange:c=>h(s,c),className:"hidden",disabled:l}),e.jsx("span",{className:"inline-block px-4 py-2 bg-[#D2A44C] text-white rounded-lg cursor-pointer hover:bg-yellow-600 transition-all text-sm",children:"Re-upload"})]})]}):e.jsxs("label",{className:"block",children:[e.jsx("input",{type:"file",accept:"image/*,.pdf",onChange:c=>h(s,c),className:"hidden",disabled:l}),e.jsx("span",{className:`inline-flex items-center gap-2 px-4 py-2 rounded-lg transition-all text-sm ${l?"bg-gray-700 text-gray-400 cursor-not-allowed":"bg-[#D2A44C] text-white cursor-pointer hover:bg-yellow-600"}`,children:l?e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"w-4 h-4 animate-spin"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"w-4 h-4"}),"Upload Document"]})})]})]})]})},s)})}),e.jsxs("div",{className:"bg-gradient-to-br from-gray-800/50 to-gray-900/50 rounded-xl p-6 border border-gray-700/50",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Verification Benefits"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 bg-gray-800/50 rounded-lg border border-gray-700/50",children:[e.jsx("div",{className:"text-[#D2A44C] font-bold mb-2",children:"Tier 1"}),e.jsxs("div",{className:"text-sm text-gray-300 space-y-1",children:[e.jsx("div",{children:"• $1,000/day withdrawal"}),e.jsx("div",{children:"• Basic trading"}),e.jsx("div",{children:"• Standard features"})]})]}),e.jsxs("div",{className:"p-4 bg-gray-800/50 rounded-lg border border-gray-700/50",children:[e.jsx("div",{className:"text-[#D2A44C] font-bold mb-2",children:"Tier 2"}),e.jsxs("div",{className:"text-sm text-gray-300 space-y-1",children:[e.jsx("div",{children:"• $10,000/day withdrawal"}),e.jsx("div",{children:"• Advanced trading"}),e.jsx("div",{children:"• Priority support"})]})]}),e.jsxs("div",{className:"p-4 bg-gray-800/50 rounded-lg border border-gray-700/50",children:[e.jsx("div",{className:"text-[#D2A44C] font-bold mb-2",children:"Tier 3"}),e.jsxs("div",{className:"text-sm text-gray-300 space-y-1",children:[e.jsx("div",{children:"• Unlimited withdrawals"}),e.jsx("div",{children:"• VIP features"}),e.jsx("div",{children:"• Dedicated manager"})]})]})]})]})]})}export{T as default};
