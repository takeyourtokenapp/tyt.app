import{c as K,aq as H,r as b,ar as J,as as T,ak as Q,z as S,at as E,j as e,A as X,S as Z,g as ee,O as te,o as $,D as re}from"./index-Cb_Vey4A.js";import{L as q}from"./loader-2-CvgjdlF_.js";import{P as se}from"./play-Da5M0EZN.js";import{R as ne}from"./refresh-cw-DbeEGu-Y.js";const ae=K("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]);function D(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;let s,o;if(Array.isArray(t)&&Array.isArray(n)){if(s=t.length,s!==n.length)return!1;for(o=s;o--!==0;)if(!D(t[o],n[o]))return!1;return!0}if(typeof t.valueOf=="function"&&t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(typeof t.toString=="function"&&t.toString!==Object.prototype.toString)return t.toString()===n.toString();const c=Object.keys(t);if(s=c.length,s!==Object.keys(n).length)return!1;for(o=s;o--!==0;)if(!Object.hasOwn(n,c[o]))return!1;for(o=s;o--!==0;){const d=c[o];if(d&&!D(t[d],n[d]))return!1}return!0}return t!==t&&n!==n}function M(t){const n=t.state.current,s=t.state.connections.get(n),o=s?.accounts,c=o?.[0],d=t.chains.find(f=>f.id===s?.chainId),i=t.state.status;switch(i){case"connected":return{address:c,addresses:o,chain:d,chainId:s?.chainId,connector:s?.connector,isConnected:!0,isConnecting:!1,isDisconnected:!1,isReconnecting:!1,status:i};case"reconnecting":return{address:c,addresses:o,chain:d,chainId:s?.chainId,connector:s?.connector,isConnected:!!c,isConnecting:!1,isDisconnected:!1,isReconnecting:!0,status:i};case"connecting":return{address:c,addresses:o,chain:d,chainId:s?.chainId,connector:s?.connector,isConnected:!1,isConnecting:!0,isDisconnected:!1,isReconnecting:!1,status:i};case"disconnected":return{address:void 0,addresses:void 0,chain:void 0,chainId:void 0,connector:void 0,isConnected:!1,isConnecting:!1,isDisconnected:!0,isReconnecting:!1,status:i}}}function oe(t,n){const{onChange:s}=n;return t.subscribe(()=>M(t),s,{equalityFn(o,c){const{connector:d,...i}=o,{connector:f,...x}=c;return D(i,x)&&d?.id===f?.id&&d?.uid===f?.uid}})}const ie="3.1.0",ce=()=>`wagmi@${ie}`;class le extends H{constructor(){super(...arguments),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"WagmiError"})}get docsBaseUrl(){return"https://wagmi.sh/react"}get version(){return ce()}}class de extends le{constructor(){super("`useConfig` must be used within `WagmiProvider`.",{docsPath:"/api/WagmiProvider"}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"WagmiProviderNotFoundError"})}}function ue(t={}){const n=t.config??b.useContext(J);if(!n)throw new de;return n}var O={exports:{}},R={},A={exports:{}},I={};var B;function fe(){if(B)return I;B=1;var t=T();function n(l,u){return l===u&&(l!==0||1/l===1/u)||l!==l&&u!==u}var s=typeof Object.is=="function"?Object.is:n,o=t.useState,c=t.useEffect,d=t.useLayoutEffect,i=t.useDebugValue;function f(l,u){var g=u(),p=o({inst:{value:g,getSnapshot:u}}),m=p[0].inst,v=p[1];return d(function(){m.value=g,m.getSnapshot=u,x(m)&&v({inst:m})},[l,g,u]),c(function(){return x(m)&&v({inst:m}),l(function(){x(m)&&v({inst:m})})},[l]),i(g),g}function x(l){var u=l.getSnapshot;l=l.value;try{var g=u();return!s(l,g)}catch{return!0}}function a(l,u){return u()}var y=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?a:f;return I.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:y,I}var L;function me(){return L||(L=1,A.exports=fe()),A.exports}var V;function ge(){if(V)return R;V=1;var t=T(),n=me();function s(a,y){return a===y&&(a!==0||1/a===1/y)||a!==a&&y!==y}var o=typeof Object.is=="function"?Object.is:s,c=n.useSyncExternalStore,d=t.useRef,i=t.useEffect,f=t.useMemo,x=t.useDebugValue;return R.useSyncExternalStoreWithSelector=function(a,y,l,u,g){var p=d(null);if(p.current===null){var m={hasValue:!1,value:null};p.current=m}else m=p.current;p=f(function(){function k(j){if(!F){if(F=!0,N=j,j=u(j),g!==void 0&&m.hasValue){var w=m.value;if(g(w,j))return C=w}return C=j}if(w=C,o(N,j))return w;var _=u(j);return g!==void 0&&g(w,_)?(N=j,w):(N=j,C=_)}var F=!1,N,C,P=l===void 0?null:l;return[function(){return k(y())},P===null?void 0:function(){return k(P())}]},[y,l,u,g]);var v=c(a,p[0],p[1]);return i(function(){m.hasValue=!0,m.value=v},[v]),x(v),v},R}var W;function xe(){return W||(W=1,O.exports=ge()),O.exports}var he=xe();const U=t=>typeof t=="object"&&!Array.isArray(t);function ye(t,n,s=n,o=D){const c=b.useRef([]),d=he.useSyncExternalStoreWithSelector(t,n,s,i=>i,(i,f)=>{if(U(i)&&U(f)&&c.current.length){for(const x of c.current)if(!o(i[x],f[x]))return!1;return!0}return o(i,f)});return b.useMemo(()=>{if(U(d)){const i={...d};let f={};for(const[x,a]of Object.entries(i))f={...f,[x]:{configurable:!1,enumerable:!0,get:()=>(c.current.includes(x)||c.current.push(x),a)}};return Object.defineProperties(i,f),i}return d},[d])}function pe(t={}){const n=ue(t);return ye(s=>oe(n,{onChange:s}),()=>M(n))}function Ne(){const{address:t,isConnected:n}=pe(),{showToast:s}=Q(),[o,c]=b.useState(!1),[d,i]=b.useState(!0),[f,x]=b.useState([]),[a,y]=b.useState({protocolFee:60,charityFee:30,academyFee:10}),[l,u]=b.useState(!1),[g,p]=b.useState(0),[m,v]=b.useState(null);b.useEffect(()=>{k()},[t]),b.useEffect(()=>{o&&(F(),N())},[o]);const k=async()=>{try{i(!0);const{data:r}=await S.auth.getUser();if(!r?.user?.id){c(!1);return}const{data:h}=await S.from("profiles").select("role, is_admin").eq("user_id",r.user.id).single();c(h?.is_admin===!0||h?.role==="admin")}catch(r){console.error("Error checking admin access:",r),c(!1)}finally{i(!1)}},F=async()=>{try{const r=[{name:"Miner NFT",address:E.minerNFT,isPaused:!1,balance:"0"},{name:"Marketplace",address:E.marketplace,isPaused:!1,balance:"0"},{name:"Rewards Merkle",address:E.rewardsMerkle,isPaused:!1,balance:"0"},{name:"Charity Vault",address:E.charityVault,isPaused:!1,balance:"0"},{name:"Academy Vault",address:E.academyVault,isPaused:!1,balance:"0"},{name:"Fee Config",address:E.feeConfig,isPaused:!1,balance:"0"}];x(r)}catch(r){console.error("Error loading contract data:",r)}},N=async()=>{try{const{data:r}=await S.from("token_burns").select("amount_tyt, status, created_at").eq("status","pending").order("created_at",{ascending:!1});if(r){const z=r.reduce((Y,G)=>Y+parseFloat(G.amount_tyt),0);p(z)}const{data:h}=await S.from("token_burns").select("executed_at").eq("status","executed").order("executed_at",{ascending:!1}).limit(1).single();h?.executed_at&&v(new Date(h.executed_at))}catch(r){console.error("Error loading burn data:",r)}},C=async r=>{try{s(`Pausing ${r}...`,"info"),s(`${r} paused successfully`,"success"),await F()}catch(h){console.error("Error pausing contract:",h),s(h.message||"Failed to pause contract","error")}},P=async r=>{try{s(`Unpausing ${r}...`,"info"),s(`${r} unpaused successfully`,"success"),await F()}catch(h){console.error("Error unpausing contract:",h),s(h.message||"Failed to unpause contract","error")}},j=async()=>{if(a.protocolFee+a.charityFee+a.academyFee!==100){s("Fee percentages must add up to 100%","error");return}u(!0);try{s("Updating fee configuration...","info"),s("Fee configuration updated successfully","success")}catch(r){console.error("Error updating fees:",r),s(r.message||"Failed to update fees","error")}finally{u(!1)}},w=async()=>{try{s("Executing token burn...","info");const{data:r}=await S.auth.getUser();if(!r?.user?.id)return;const{data:h}=await S.from("profiles").select("id").eq("user_id",r.user.id).single();if(!h)return;await S.from("token_burns").update({status:"executed",executed_at:new Date().toISOString(),executed_by:h.id}).eq("status","pending"),s(`Successfully burned ${g.toFixed(2)} TYT`,"success"),await N()}catch(r){console.error("Error executing burn:",r),s(r.message||"Failed to execute burn","error")}},_=async()=>{try{s("Distributing charity fees...","info"),s("Charity fees distributed successfully","success")}catch(r){console.error("Error distributing fees:",r),s(r.message||"Failed to distribute fees","error")}};return d?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(q,{className:"w-12 h-12 text-yellow-400 animate-spin"})}):o?e.jsxs("div",{className:"max-w-7xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Z,{className:"w-10 h-10 text-yellow-400"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Contract Management"}),e.jsx("p",{className:"text-gray-400",children:"Manage smart contracts and protocol configuration"})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:f.map(r=>e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-1",children:r.name}),e.jsx("p",{className:"text-sm text-gray-400 font-mono break-all",children:r.address})]}),e.jsx("div",{className:`px-3 py-1 rounded-full text-xs font-medium ${r.isPaused?"bg-red-500/20 text-red-400":"bg-green-500/20 text-green-400"}`,children:r.isPaused?"Paused":"Active"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>r.isPaused?P(r.name):C(r.name),className:`flex-1 py-2 px-4 rounded-lg font-medium transition-colors ${r.isPaused?"bg-green-500/20 hover:bg-green-500/30 text-green-400":"bg-red-500/20 hover:bg-red-500/30 text-red-400"}`,children:r.isPaused?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx(se,{className:"w-4 h-4"}),"Unpause"]}):e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx(ae,{className:"w-4 h-4"}),"Pause"]})}),e.jsx("a",{href:`undefined/address/${r.address}`,target:"_blank",rel:"noopener noreferrer",className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg font-medium transition-colors",children:"View"})]})]},r.address))}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(ee,{className:"w-6 h-6 text-yellow-400"}),e.jsx("h2",{className:"text-xl font-bold text-white",children:"Fee Configuration"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Protocol Fee (%)"}),e.jsx("input",{type:"number",min:"0",max:"100",value:a.protocolFee,onChange:r=>y({...a,protocolFee:parseInt(r.target.value)||0}),className:"w-full px-4 py-3 bg-gray-900 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-yellow-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Charity Fee (%)"}),e.jsx("input",{type:"number",min:"0",max:"100",value:a.charityFee,onChange:r=>y({...a,charityFee:parseInt(r.target.value)||0}),className:"w-full px-4 py-3 bg-gray-900 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-yellow-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Academy Fee (%)"}),e.jsx("input",{type:"number",min:"0",max:"100",value:a.academyFee,onChange:r=>y({...a,academyFee:parseInt(r.target.value)||0}),className:"w-full px-4 py-3 bg-gray-900 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-yellow-500"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-900 rounded-lg mb-4",children:[e.jsx("span",{className:"text-gray-400",children:"Total"}),e.jsxs("span",{className:`text-lg font-bold ${a.protocolFee+a.charityFee+a.academyFee===100?"text-green-400":"text-red-400"}`,children:[a.protocolFee+a.charityFee+a.academyFee,"%"]})]}),e.jsx("button",{onClick:j,disabled:l||a.protocolFee+a.charityFee+a.academyFee!==100,className:"w-full py-3 bg-gradient-to-r from-yellow-500 to-orange-500 hover:from-yellow-600 hover:to-orange-600 text-white rounded-lg font-bold transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:l?e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"w-5 h-5 animate-spin"}),"Updating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"w-5 h-5"}),"Update Fee Configuration"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-orange-500/10 to-red-500/10 border border-orange-500/20 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx($,{className:"w-6 h-6 text-orange-400"}),e.jsx("h2",{className:"text-xl font-bold text-white",children:"Token Burn"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Pending Burn"}),e.jsxs("div",{className:"text-3xl font-bold text-orange-400",children:[g.toLocaleString()," TYT"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Last Burn"}),e.jsx("div",{className:"text-white",children:m?m.toLocaleString():"Never"})]}),e.jsxs("button",{onClick:w,disabled:g===0,className:"w-full py-3 bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white rounded-lg font-bold transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[e.jsx($,{className:"w-5 h-5"}),"Execute Burn"]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-500/10 to-blue-500/10 border border-green-500/20 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(re,{className:"w-6 h-6 text-green-400"}),e.jsx("h2",{className:"text-xl font-bold text-white",children:"Fee Distribution"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Accumulated Charity Fees"}),e.jsx("div",{className:"text-3xl font-bold text-green-400",children:"$0.00"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Last Distribution"}),e.jsx("div",{className:"text-white",children:"Never"})]}),e.jsxs("button",{onClick:_,className:"w-full py-3 bg-gradient-to-r from-green-500 to-blue-500 hover:from-green-600 hover:to-blue-600 text-white rounded-lg font-bold transition-all flex items-center justify-center gap-2",children:[e.jsx(ne,{className:"w-5 h-5"}),"Distribute Fees"]})]})]})]})]}):e.jsx("div",{className:"max-w-2xl mx-auto p-6",children:e.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-xl p-12 text-center",children:[e.jsx(X,{className:"w-16 h-16 text-red-400 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-gray-400",children:"You don't have permission to access the contract management panel."})]})})}export{Ne as default};
