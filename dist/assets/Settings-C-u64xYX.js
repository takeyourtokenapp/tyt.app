import{c as E,z as p,E as j,r as n,j as e,_ as w,O as h,A as C,f as K,S as y,ai as Y,ah as D,F as U,aj as z}from"./index-Cb_Vey4A.js";import{C as S}from"./clock-ClFQAG9n.js";import{U as B}from"./upload-D6vFaWue.js";import{S as $}from"./save-CZaQ-6kZ.js";const L=E("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);async function _(s){try{const{data:a,error:r}=await p.from("profiles").select("*").eq("id",s).single();return r?(console.error("Get user profile error:",r),null):a}catch(a){return console.error("Get user profile error:",a),null}}async function k(s){try{const a=await _(s);if(!a)return{status:"not_submitted",tier:0,documents:[]};const{data:r}=await p.from("kyc_documents").select("document_type, status, uploaded_at, rejection_reason").eq("id",s).order("uploaded_at",{ascending:!1});return{status:a.kyc_status,tier:a.kyc_tier,documents:r||[]}}catch(a){return console.error("Get KYC status error:",a),{status:"not_submitted",tier:0,documents:[]}}}function R(s){return{0:["Withdraw funds to external wallets","Stake TYT tokens","Buy and sell NFT miners","Claim mining rewards"],1:["Access governance voting","Premium trading features","Higher withdrawal limits","Priority support"],2:["VIP features and benefits","Exclusive market access","Maximum withdrawal limits","Dedicated account manager"]}[s]||[]}function F(){const{user:s}=j(),[a,r]=n.useState(null),[o,l]=n.useState(!0);return n.useEffect(()=>{async function u(){if(!s){r(null),l(!1);return}const c=await _(s.id);r(c),l(!1)}u()},[s]),{profile:a,loading:o}}function V(){const{user:s}=j(),[a,r]=n.useState(null),[o,l]=n.useState(!0);return n.useEffect(()=>{async function c(){if(!s){r(null),l(!1);return}const i=await k(s.id);r(i),l(!1)}c()},[s]),{kycStatus:a,loading:o,refresh:async()=>{if(!s)return;l(!0);const c=await k(s.id);r(c),l(!1)}}}function q(){const{kycStatus:s,loading:a}=V(),{profile:r}=F();if(a||!s)return e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx("div",{className:"w-6 h-6 border-3 border-gold-400 border-t-transparent rounded-full animate-spin"})});const l={not_submitted:{icon:C,color:"text-gray-400",bgColor:"bg-gray-500/20",borderColor:"border-gray-500/50",label:"Not Submitted"},pending:{icon:S,color:"text-yellow-400",bgColor:"bg-yellow-500/20",borderColor:"border-yellow-500/50",label:"Under Review"},approved:{icon:h,color:"text-green-400",bgColor:"bg-green-500/20",borderColor:"border-green-500/50",label:"Approved"},rejected:{icon:w,color:"text-red-400",bgColor:"bg-red-500/20",borderColor:"border-red-500/50",label:"Rejected"}}[s.status],u=l.icon,c=r?R(r.kyc_tier):[];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:`rounded-xl p-6 border ${l.borderColor} ${l.bgColor}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-3 rounded-xl ${l.bgColor}`,children:e.jsx(u,{className:`w-6 h-6 ${l.color}`})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold",children:"KYC Status"}),e.jsx("p",{className:`text-sm ${l.color} font-semibold`,children:l.label})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Current Tier"}),e.jsx("div",{className:"text-3xl font-bold text-gold-400",children:s.tier})]})]}),s.status==="not_submitted"&&e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-gray-300 mb-4",children:"Complete KYC verification to unlock more features and higher limits."}),e.jsxs("button",{onClick:()=>window.location.href="/app/settings?tab=kyc",className:"w-full px-4 py-3 bg-gradient-to-r from-gold-500 to-amber-500 rounded-lg font-semibold hover:from-gold-400 hover:to-amber-400 transition-all flex items-center justify-center gap-2",children:[e.jsx(B,{size:18}),"Start KYC Verification"]})]}),s.status==="pending"&&e.jsx("div",{className:"mt-4 p-4 bg-gray-800/50 rounded-lg",children:e.jsx("p",{className:"text-sm text-gray-300",children:"Your documents are being reviewed. This typically takes 1-3 business days."})}),s.status==="rejected"&&e.jsxs("div",{className:"mt-4 p-4 bg-red-500/10 rounded-lg border border-red-500/50",children:[e.jsx("p",{className:"text-sm text-red-400 font-semibold mb-2",children:"Verification rejected"}),e.jsx("p",{className:"text-sm text-gray-300",children:"Please check your documents and resubmit."})]})]}),s.documents.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 rounded-xl p-6 border border-gray-700",children:[e.jsx("h4",{className:"font-bold text-lg mb-4",children:"Submitted Documents"}),e.jsx("div",{className:"space-y-3",children:s.documents.map((i,m)=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-800/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold capitalize",children:i.type.replace(/_/g," ")}),e.jsxs("div",{className:"text-sm text-gray-400",children:["Uploaded: ",new Date(i.uploaded_at).toLocaleDateString()]}),i.rejection_reason&&e.jsxs("div",{className:"text-sm text-red-400 mt-1",children:["Reason: ",i.rejection_reason]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[i.status==="approved"&&e.jsxs("span",{className:"px-3 py-1 bg-green-500/20 text-green-400 rounded-lg text-sm font-semibold flex items-center gap-1",children:[e.jsx(h,{size:14}),"Approved"]}),i.status==="pending"&&e.jsxs("span",{className:"px-3 py-1 bg-yellow-500/20 text-yellow-400 rounded-lg text-sm font-semibold flex items-center gap-1",children:[e.jsx(S,{size:14}),"Pending"]}),i.status==="rejected"&&e.jsxs("span",{className:"px-3 py-1 bg-red-500/20 text-red-400 rounded-lg text-sm font-semibold flex items-center gap-1",children:[e.jsx(w,{size:14}),"Rejected"]})]})]},m))})]}),r&&r.kyc_tier<3&&c.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-gold-500/10 to-amber-500/10 rounded-xl p-6 border border-gold-500/50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(K,{className:"w-5 h-5 text-gold-400"}),e.jsxs("h4",{className:"font-bold text-lg",children:["Tier ",r.kyc_tier+1," Benefits"]})]}),e.jsx("ul",{className:"space-y-2",children:c.map((i,m)=>e.jsxs("li",{className:"flex items-start gap-2 text-sm text-gray-300",children:[e.jsx(h,{className:"w-4 h-4 text-green-400 flex-shrink-0 mt-0.5"}),e.jsx("span",{children:i})]},m))}),s.status==="approved"&&e.jsxs("button",{onClick:()=>window.location.href="/app/settings?tab=kyc",className:"mt-4 w-full px-4 py-3 bg-gradient-to-r from-gold-500 to-amber-500 rounded-lg font-semibold hover:from-gold-400 hover:to-amber-400 transition-all",children:["Upgrade to Tier ",r.kyc_tier+1]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 rounded-xl p-6 border border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(y,{className:"w-5 h-5 text-blue-400"}),e.jsx("h4",{className:"font-bold text-lg",children:"KYC Tiers"})]}),e.jsx("div",{className:"space-y-4",children:[{tier:0,name:"Unverified",features:["View wallet","Deposit funds","Basic trading"]},{tier:1,name:"Basic",features:["Withdraw funds","Stake tokens","Buy/sell miners","Claim rewards"]},{tier:2,name:"Intermediate",features:["Governance voting","Premium trading","Higher limits","Priority support"]},{tier:3,name:"Advanced",features:["VIP features","Exclusive access","Maximum limits","Dedicated manager"]}].map(i=>e.jsxs("div",{className:`p-4 rounded-lg border ${r&&r.kyc_tier===i.tier?"border-gold-500 bg-gold-500/10":"border-gray-700 bg-gray-800/50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"font-bold",children:["Tier ",i.tier," - ",i.name]}),r&&r.kyc_tier===i.tier&&e.jsx("span",{className:"px-2 py-1 bg-gold-500/20 text-gold-400 rounded text-xs font-semibold",children:"Current"})]}),e.jsx("ul",{className:"space-y-1",children:i.features.map((m,g)=>e.jsxs("li",{className:"text-sm text-gray-400 flex items-center gap-2",children:[e.jsx("div",{className:"w-1 h-1 rounded-full bg-gold-400"}),m]},g))})]},i.tier))})]})]})}function W(){const{user:s}=j(),[a,r]=Y(),[o,l]=n.useState(a.get("tab")||"account"),[u,c]=n.useState(null),[i,m]=n.useState(!0),[g,v]=n.useState(!1),[x,f]=n.useState(null),[d,b]=n.useState({username:"",email:"",notifications_email:!0,notifications_push:!0,two_factor_enabled:!1});n.useEffect(()=>{const t=a.get("tab");t&&["account","security","kyc","notifications"].includes(t)&&l(t)},[a]),n.useEffect(()=>{s&&P()},[s]);const P=async()=>{if(s)try{const{data:t,error:N}=await p.from("profiles").select("*").eq("id",s.id).maybeSingle();if(N)throw N;t&&(c(t),b({username:t.username||"",email:s.email||"",notifications_email:!0,notifications_push:!0,two_factor_enabled:!1}))}catch(t){console.error("Error loading profile:",t)}finally{m(!1)}},T=async()=>{v(!0),f(null);try{const{error:t}=await p.from("profiles").update({username:d.username}).eq("id",s.id);if(t)throw t;f({type:"success",text:"Settings saved successfully!"}),setTimeout(()=>f(null),3e3)}catch{f({type:"error",text:"Failed to save settings"})}finally{v(!1)}},A=t=>{l(t),r({tab:t})};return i?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-400",children:"Loading settings..."})}):e.jsxs("div",{className:"space-y-6 max-w-4xl",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Settings"}),e.jsx("p",{className:"text-gray-400",children:"Manage your account and preferences"})]}),x&&e.jsxs("div",{className:`p-4 rounded-lg border flex items-center gap-3 ${x.type==="success"?"bg-green-500/10 border-green-500/50":"bg-red-500/10 border-red-500/50"}`,children:[x.type==="success"?e.jsx(h,{className:"w-5 h-5 text-green-400"}):e.jsx(C,{className:"w-5 h-5 text-red-400"}),e.jsx("span",{className:x.type==="success"?"text-green-400":"text-red-400",children:x.text})]}),e.jsxs("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 rounded-xl border border-gray-700",children:[e.jsx("div",{className:"flex border-b border-gray-700",children:[{id:"account",label:"Account",icon:D},{id:"security",label:"Security",icon:y},{id:"kyc",label:"KYC Verification",icon:U},{id:"notifications",label:"Notifications",icon:z}].map(t=>e.jsxs("button",{onClick:()=>A(t.id),className:`flex-1 px-6 py-4 font-semibold transition-all flex items-center justify-center gap-2 ${o===t.id?"bg-gold-500/20 text-gold-400 border-b-2 border-gold-500":"text-gray-400 hover:text-white hover:bg-gray-800/50"}`,children:[e.jsx(t.icon,{size:18}),e.jsx("span",{className:"hidden sm:inline",children:t.label})]},t.id))}),e.jsxs("div",{className:"p-6",children:[o==="account"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Profile Information"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Username"}),e.jsx("input",{type:"text",value:d.username,onChange:t=>b({...d,username:t.target.value}),placeholder:"Enter username",className:"w-full px-4 py-3 bg-gray-900 border border-gray-700 rounded-lg focus:outline-none focus:border-gold-500 transition-colors"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Email"}),e.jsx("input",{type:"email",value:d.email,disabled:!0,className:"w-full px-4 py-3 bg-gray-900 border border-gray-700 rounded-lg opacity-50 cursor-not-allowed"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Email cannot be changed"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Account ID"}),e.jsx("input",{type:"text",value:s?.id||"",disabled:!0,className:"w-full px-4 py-3 bg-gray-900 border border-gray-700 rounded-lg opacity-50 cursor-not-allowed font-mono text-sm"})]}),e.jsxs("button",{onClick:T,disabled:g,className:"w-full px-4 py-3 bg-gradient-to-r from-gold-500 to-amber-500 rounded-lg font-semibold hover:from-gold-400 hover:to-amber-400 transition-all disabled:opacity-50 flex items-center justify-center gap-2",children:[e.jsx($,{size:18}),g?"Saving...":"Save Changes"]})]})]})}),o==="security"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Security Settings"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-800/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold mb-1 flex items-center gap-2",children:[e.jsx(L,{className:"w-5 h-5 text-gold-400"}),"Two-Factor Authentication"]}),e.jsx("div",{className:"text-sm text-gray-400",children:"Add an extra layer of security to your account"})]}),e.jsx("button",{className:"px-4 py-2 bg-gray-700 rounded-lg font-semibold hover:bg-gray-600 transition-all",children:"Enable"})]}),e.jsxs("div",{className:"p-4 bg-gray-800/50 rounded-lg",children:[e.jsxs("div",{className:"font-semibold mb-2 flex items-center gap-2",children:[e.jsx(y,{className:"w-5 h-5 text-blue-400"}),"Active Sessions"]}),e.jsx("div",{className:"text-sm text-gray-400 mb-4",children:"You are currently signed in on this device"}),e.jsx("button",{className:"px-4 py-2 bg-red-500/20 text-red-400 rounded-lg font-semibold hover:bg-red-500/30 transition-all",children:"Sign Out All Devices"})]})]})]})}),o==="kyc"&&e.jsx("div",{children:e.jsx(q,{})}),o==="notifications"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Notification Preferences"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-800/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold mb-1",children:"Email Notifications"}),e.jsx("div",{className:"text-sm text-gray-400",children:"Receive updates about your account via email"})]}),e.jsx("input",{type:"checkbox",checked:d.notifications_email,onChange:t=>b({...d,notifications_email:t.target.checked}),className:"w-6 h-6 rounded border-gray-700 bg-gray-900 text-gold-500 focus:ring-gold-500"})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-800/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold mb-1",children:"Push Notifications"}),e.jsx("div",{className:"text-sm text-gray-400",children:"Receive push notifications for important events"})]}),e.jsx("input",{type:"checkbox",checked:d.notifications_push,onChange:t=>b({...d,notifications_push:t.target.checked}),className:"w-6 h-6 rounded border-gray-700 bg-gray-900 text-gold-500 focus:ring-gold-500"})]})]})]})})]})]})]})}export{W as default};
