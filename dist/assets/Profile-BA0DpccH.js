import{c as P,E as _,r as n,z as h,j as e,ah as $,X as C,n as F,f as k,S as T,e as D}from"./index-Cb_Vey4A.js";import{T as E}from"./transactionService-O2XYPVPl.js";import{S as M}from"./save-CZaQ-6kZ.js";import{C as A}from"./calendar-DfOGD8DU.js";const U=P("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);function Y(){const{user:t}=_(),[s,c]=n.useState(null),[a,j]=n.useState(null),[b,x]=n.useState(!1),[y,N]=n.useState(!0),[u,g]=n.useState(!1),[d,i]=n.useState({username:"",full_name:""});n.useEffect(()=>{t&&(f(),v())},[t]);const f=async()=>{if(t)try{const{data:r,error:o}=await h.from("profiles").select("*").eq("id",t.id).maybeSingle();if(o)throw o;r&&(c(r),i({username:r.username||"",full_name:r.full_name||""}))}catch(r){console.error("Error loading profile:",r)}finally{N(!1)}},v=async()=>{if(!t)return;const r=await E.getUserTransactionStats(t.id);j(r)},w=async()=>{if(t){g(!0);try{const{error:r}=await h.from("profiles").update({username:d.username,full_name:d.full_name,updated_at:new Date().toISOString()}).eq("id",t.id);if(r)throw r;await f(),x(!1)}catch(r){console.error("Error saving profile:",r),alert("Failed to save profile. Please try again.")}finally{g(!1)}}},p=r=>{switch(r?.toLowerCase()){case"bronze":return"from-amber-700 to-orange-700";case"silver":return"from-gray-400 to-gray-500";case"gold":return"from-amber-400 to-yellow-500";case"platinum":return"from-cyan-400 to-blue-500";case"diamond":return"from-purple-400 to-pink-500";default:return"from-gray-600 to-gray-700"}},S=r=>{switch(r){case 0:return{text:"Not Verified",color:"text-gray-400",bg:"bg-gray-500/20"};case 1:return{text:"Tier 1 Verified",color:"text-blue-400",bg:"bg-blue-500/20"};case 2:return{text:"Tier 2 Verified",color:"text-green-400",bg:"bg-green-500/20"};case 3:return{text:"Tier 3 Verified",color:"text-purple-400",bg:"bg-purple-500/20"};default:return{text:"Unknown",color:"text-gray-400",bg:"bg-gray-500/20"}}};if(y)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full"})});if(!s)return e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-400",children:"Profile not found"})});const m=S(s.kyc_level);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"My Profile"}),!b&&e.jsxs("button",{onClick:()=>x(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-500/20 text-blue-400 rounded-lg hover:bg-blue-500/30 transition-colors border border-blue-500/50",children:[e.jsx(U,{className:"w-4 h-4"}),"Edit Profile"]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 border border-gray-700 rounded-xl overflow-hidden",children:[e.jsx("div",{className:`h-32 bg-gradient-to-r ${p(s.vip_tier)}`}),e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-6 -mt-20 mb-6",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-32 h-32 rounded-full bg-gradient-to-br from-blue-500 to-cyan-500 border-4 border-gray-900 flex items-center justify-center shadow-xl",children:s.avatar_url?e.jsx("img",{src:s.avatar_url,alt:"Avatar",className:"w-full h-full rounded-full object-cover"}):e.jsx($,{className:"w-16 h-16 text-white"})})}),e.jsx("div",{className:"flex-1 mt-16 md:mt-0",children:b?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Username"}),e.jsx("input",{type:"text",value:d.username,onChange:r=>i(o=>({...o,username:r.target.value})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg focus:outline-none focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Full Name"}),e.jsx("input",{type:"text",value:d.full_name,onChange:r=>i(o=>({...o,full_name:r.target.value})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg focus:outline-none focus:border-blue-500"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:w,disabled:u,className:"flex items-center gap-2 px-4 py-2 bg-green-500/20 text-green-400 rounded-lg hover:bg-green-500/30 transition-colors border border-green-500/50 disabled:opacity-50",children:[e.jsx(M,{className:"w-4 h-4"}),u?"Saving...":"Save Changes"]}),e.jsxs("button",{onClick:()=>{x(!1),i({username:s.username||"",full_name:s.full_name||""})},className:"flex items-center gap-2 px-4 py-2 bg-gray-700 rounded-lg hover:bg-gray-600 transition-colors",children:[e.jsx(C,{className:"w-4 h-4"}),"Cancel"]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h2",{className:"text-3xl font-bold",children:s.username||"User"}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${m.bg} ${m.color} border border-current`,children:m.text})]}),s.full_name&&e.jsx("p",{className:"text-gray-400 mb-4",children:s.full_name}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{className:"w-4 h-4"}),s.email]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{className:"w-4 h-4"}),"Joined ",new Date(s.created_at).toLocaleDateString()]})]})]})})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:`bg-gradient-to-br ${p(s.vip_tier)} bg-opacity-20 border border-current rounded-xl p-4`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(k,{className:"w-6 h-6"}),e.jsx("span",{className:"font-bold",children:"VIP Status"})]}),e.jsx("p",{className:"text-2xl font-bold",children:s.vip_tier||"None"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Your membership tier"})]}),e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/50 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(T,{className:"w-6 h-6 text-blue-400"}),e.jsx("span",{className:"font-bold",children:"KYC Level"})]}),e.jsxs("p",{className:"text-2xl font-bold text-blue-400",children:["Tier ",s.kyc_level]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Verification status"})]}),e.jsxs("div",{className:"bg-purple-500/10 border border-purple-500/50 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(D,{className:"w-6 h-6 text-purple-400"}),e.jsx("span",{className:"font-bold",children:"Referral Code"})]}),e.jsx("p",{className:"text-2xl font-bold text-purple-400",children:s.referral_code}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Share to earn rewards"})]})]})]})]}),a&&e.jsxs("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 border border-gray-700 rounded-xl p-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Activity Statistics"}),e.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(l,{label:"Total Deposits",value:`$${a.totalDeposits.toFixed(2)}`,color:"green"}),e.jsx(l,{label:"Total Withdrawals",value:`$${a.totalWithdrawals.toFixed(2)}`,color:"red"}),e.jsx(l,{label:"Mining Rewards",value:`$${a.totalMiningRewards.toFixed(2)}`,color:"blue"}),e.jsx(l,{label:"Foundation Contributions",value:`$${a.foundationContributions.toFixed(2)}`,color:"pink"}),e.jsx(l,{label:"Maintenance Paid",value:`$${a.totalMaintenancePaid.toFixed(2)}`,color:"amber"}),e.jsx(l,{label:"NFT Purchases",value:`$${a.totalNFTPurchases.toFixed(2)}`,color:"purple"}),e.jsx(l,{label:"NFT Sales",value:`$${a.totalNFTSales.toFixed(2)}`,color:"cyan"}),e.jsx(l,{label:"Net Profit",value:`$${(a.totalMiningRewards-a.totalMaintenancePaid).toFixed(2)}`,color:"emerald"})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 border border-gray-700 rounded-xl p-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Security & Privacy"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-800/50 rounded-lg border border-gray-700",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-1",children:"Two-Factor Authentication (2FA)"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Add an extra layer of security to your account"})]}),e.jsx("button",{className:"px-4 py-2 bg-blue-500/20 text-blue-400 rounded-lg hover:bg-blue-500/30 transition-colors border border-blue-500/50",children:"Enable"})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-800/50 rounded-lg border border-gray-700",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-1",children:"Change Password"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Update your password regularly for security"})]}),e.jsx("button",{className:"px-4 py-2 bg-gray-700 rounded-lg hover:bg-gray-600 transition-colors",children:"Change"})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-800/50 rounded-lg border border-gray-700",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-1",children:"Download Your Data"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Export all your personal data (GDPR compliance)"})]}),e.jsx("button",{className:"px-4 py-2 bg-gray-700 rounded-lg hover:bg-gray-600 transition-colors",children:"Download"})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-red-500/10 rounded-lg border border-red-500/50",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-1 text-red-400",children:"Delete Account"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Permanently delete your account and data"})]}),e.jsx("button",{className:"px-4 py-2 bg-red-500/20 text-red-400 rounded-lg hover:bg-red-500/30 transition-colors border border-red-500/50",children:"Delete"})]})]})]})]})}function l({label:t,value:s,color:c}){const a={green:"bg-green-500/10 border-green-500/50 text-green-400",red:"bg-red-500/10 border-red-500/50 text-red-400",blue:"bg-blue-500/10 border-blue-500/50 text-blue-400",pink:"bg-pink-500/10 border-pink-500/50 text-pink-400",amber:"bg-amber-500/10 border-amber-500/50 text-amber-400",purple:"bg-purple-500/10 border-purple-500/50 text-purple-400",cyan:"bg-cyan-500/10 border-cyan-500/50 text-cyan-400",emerald:"bg-emerald-500/10 border-emerald-500/50 text-emerald-400"};return e.jsxs("div",{className:`${a[c]} border rounded-xl p-4`,children:[e.jsx("p",{className:"text-sm text-gray-400 mb-1",children:t}),e.jsx("p",{className:"text-2xl font-bold",children:s})]})}export{Y as default};
